<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case study 1: Constant growth with SUSTAIN Trout data ‚Ä¢ hmde</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study 1: Constant growth with SUSTAIN Trout data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hmde</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hmde.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/constant-growth.html">Constant growth model</a></li>
    <li><a class="dropdown-item" href="../articles/von-bertalanffy.html">von Bertalanffy model</a></li>
    <li><a class="dropdown-item" href="../articles/canham.html">Canham model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/traitecoevo/austraits/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Case study 1: Constant growth with SUSTAIN Trout data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/traitecoevo/austraits/blob/master/vignettes/constant-growth.Rmd" class="external-link"><code>vignettes/constant-growth.Rmd</code></a></small>
      <div class="d-none name"><code>constant-growth.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In circumstances where the number of observations available per
individual is very limited, average growth rates over time may be the
only plausible model to fit. In particular, if there are individuals
with only two size observations, than the best that can be done is a
single estimate of growth rate based on that interval. Such a model
behaves as <strong>constant growth</strong>, which we can think of as
the average rate of change across the observation period and is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ≤</mi></mrow><annotation encoding="application/x-tex">\begin{equation}\tag{3}\label{eqn_3_const}
f(Y(t), \beta) = \beta
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the average growth rate. The constant growth model corresponds to
linear sizes over time, and is equivalent to a linear mixed model for
size, where there is an individual effect when fit to multiple
individuals.</p>
<div class="section level3">
<h3 id="load-dependencies">Load dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remotes::install_github("traitecoevo/hmde")</span></span>
<span><span class="co"># install.packages(c("dplyr", "ggplot2"))</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://traitecoevo.github.io/hmde/">hmde</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<p>The default priors for the constant top-level parameters in the
single individual model are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≤</mi><mo>‚àº</mo><mo>log</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\beta\sim \log\mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>œÉ</mi><mi>e</mi></msub><mo>‚àº</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">0 &lt;\sigma_e \sim Cauchy(0, 2).</annotation></semantics></math></p>
<p>For the multi-individual model the prior structure and default
parameters are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>Œ≤</mi></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mu_{\beta} \sim \mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>œÉ</mi><mi>Œ≤</mi></msub><mo>‚àº</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">0 &lt; \sigma_{\beta} \sim Cauchy(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>œÉ</mi><mi>e</mi></msub><mo>‚àº</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">0 &lt; \sigma_{e} \sim Cauchy(0, 2).</annotation></semantics></math>
To change the prior parameter values (the distributions are fixed)
optional arguments can be passed to <code>hmde_assign_data</code> with
names corresponding to the <code>prior_pars</code> argument for the
associated parameter as output by <code>hmde_models()</code>. For
example in the following we want to change the prior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
(<code>ind_beta</code>) in the individual model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hmde_model.html">hmde_model</a></span><span class="op">(</span><span class="st">"constant_single_ind"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_obs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $y_obs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $obs_index</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $time</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_ind_beta</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_global_error_sigma</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; [1] "constant_single_ind"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "hmde_object"</span></span>
<span><span class="co">#prior_pars_ind_beta is the argument name for the prior parameters</span></span></code></pre></div>
<p>The mean passed to a log-normal distribution is the mean of the
<strong>underlying normal distribution</strong>, so if you want to pass
a value based on raw observations you need to log-transform it
first.</p>
<p>Let‚Äôs simulate some data to visualise the constant growth
function.</p>
</div>
<div class="section level3">
<h3 id="simulate-data">Simulate data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co">#Annual growth rate</span></span>
<span><span class="va">y_0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#Starting size</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span> </span>
<span><span class="va">sizes_over_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Y_t <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">beta</span><span class="op">*</span><span class="va">time</span>, <span class="co">#Linear sizes over time</span></span>
<span>                          t <span class="op">=</span> <span class="va">time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes_over_time</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 √ó 2</span></span></span>
<span><span class="co">#&gt;      Y_t     t</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     5     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     7     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     9     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    11     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    15     7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    17     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    19     9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 11 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualise-data">Visualise data<a class="anchor" aria-label="anchor" href="#visualise-data"></a>
</h3>
<p>Here are some plots to demonstrate how the constant growth function
relates to sizes over time for a single individual. Feel free to play
around with the parameter settings (<code>beta</code>, <code>y_0</code>)
and see how the plot changes.</p>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot of growth function</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="../reference/hmde_model_des.html">hmde_model_des</a></span><span class="op">(</span><span class="st">"constant_single_ind"</span><span class="op">)</span>, <span class="co"># Visualising the growth function</span></span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">"green4"</span>, linewidth<span class="op">=</span><span class="fl">1</span>,</span>
<span>                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_over_time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="va">y_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_over_time</span><span class="op">$</span><span class="va">Y_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Creating the x axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">beta</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Creating the y axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Y(t)"</span>, y <span class="op">=</span> <span class="st">"f"</span>, title <span class="op">=</span> <span class="st">"Constant growth"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Axe labels and plot title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Theme for the plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, <span class="co"># Plot customising</span></span>
<span>        axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#Sizes over time</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sizes_over_time</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y <span class="op">=</span> <span class="va">Y_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"green4"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Line graph of sizes_over_time</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_over_time</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_over_time</span><span class="op">$</span><span class="va">Y_t</span><span class="op">)</span><span class="op">*</span><span class="fl">1.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Y(t)"</span>, title <span class="op">=</span> <span class="st">"Constant growth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A key take-away of the function plot (on the left) is the
relationship to what we think of as a ‚Äúreasonable growth model‚Äù. We
don‚Äôt expect constant growth rates to be realistic, at best they
represent the average rate of change over a period. More complex models
may be more realistic, but in this case study we are only interested in
different mechanisms of size dependence, we do not use environmental
covariates for example.</p>
</div>
</div>
<div class="section level2">
<h2 id="sustain-trout-data">SUSTAIN trout data<a class="anchor" aria-label="anchor" href="#sustain-trout-data"></a>
</h2>
<p>Our example data for the constant model comes from <span class="citation">Moe et al. (2020)</span>, a publicly available dataset
of mark-recapture data for <em>Salmo trutta</em> in Norway. The time
between observations is not controlled, nor is the number of
observations per individual. As a result the data consists primarily of
individuals with two observations of size, constituting a single
observation of growth which limits the growth functions that can be fit
to individuals as a single parameter model is the best that can be fit
to two sizes. The constant growth function in Equation is the most
appropriate of the functions we have in <code>hmde</code>, as we can
interpret the single growth interval as an estimate of the average
growth rate that gets fit to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.</p>
<p>In order to best reflect the survey data we took a stratified sample
of individuals grouped by the number of available observations. We have
25 fish with two observations, 15 with three, 10 with four, for a total
sample size of 50. This data is included with <code>hmde</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Trout_Size_Data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 135 √ó 4</span></span></span>
<span><span class="co">#&gt;    ind_id  time y_obs obs_index</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1  0       52         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1  1.91    60         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1  4.02    70         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1  6.04    80         4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      2  0       80         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      2  1.90    85         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      2  3.94    93         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      2  5.96    94         4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      3  0       52         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      3  2.03    65         2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 125 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="transform-data">Transform data<a class="anchor" aria-label="anchor" href="#transform-data"></a>
</h3>
<p>As initial exploration we will have a look at the distribution of
observed sizes, growth behaviour, and observation intervals. First we
transform the data to extract growth increment and observation interval
information, then plot it.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Trout_Size_Data_transformed</span> <span class="op">&lt;-</span> <span class="va">Trout_Size_Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    delta_y_obs <span class="op">=</span> <span class="va">y_obs</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">)</span>,</span>
<span>    obs_interval <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>    obs_growth_rate <span class="op">=</span> <span class="va">delta_y_obs</span><span class="op">/</span><span class="va">obs_interval</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Trout_Size_Data_transformed</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 135 √ó 7</span></span></span>
<span><span class="co">#&gt;    ind_id  time y_obs obs_index delta_y_obs obs_interval obs_growth_rate</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1  0       52         1          <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1  1.91    60         2           8         1.91           4.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1  4.02    70         3          10         2.11           4.75 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1  6.04    80         4          10         2.02           4.96 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      2  0       80         1          <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      2  1.90    85         2           5         1.90           2.64 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      2  3.94    93         3           8         2.04           3.92 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      2  5.96    94         4           1         2.03           0.494</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      3  0       52         1          <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      3  2.03    65         2          13         2.03           6.42 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 125 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualise-raw-data">Visualise raw data<a class="anchor" aria-label="anchor" href="#visualise-raw-data"></a>
</h3>
<p>Let‚Äôs create some histograms to investigate the distribution of size,
growth interval and growth increments.</p>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The growth histograms show that there‚Äôs a number of negative growth
increments, some reasonably extreme, and when combined with some short
observation periods we get very extreme estimates of growth rates. We
can further investigate these if needed.</p>
<p>The constant growth model assumes non-negative growth and uses a
log-normal distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
which will eliminate those increments from the estimated sizes. We
consider eliminating negative growth biologically reasonable as we don‚Äôt
expect the length of fish to decrease over time, even if their mass or
width might.</p>
</div>
<div class="section level3">
<h3 id="fit-model-using-hmde">Fit model using {hmde}<a class="anchor" aria-label="anchor" href="#fit-model-using-hmde"></a>
</h3>
<p>Now we will actually fit the model and extract the estimates.</p>
<p>You can see what data structures are needed for the constant growth
model by calling:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hmde_model.html">hmde_model</a></span><span class="op">(</span><span class="st">"constant_multi_ind"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "n_obs"                         "n_ind"                        </span></span>
<span><span class="co">#&gt;  [3] "y_obs"                         "obs_index"                    </span></span>
<span><span class="co">#&gt;  [5] "time"                          "ind_id"                       </span></span>
<span><span class="co">#&gt;  [7] "prior_pars_pop_log_beta_mu"    "prior_pars_pop_log_beta_sigma"</span></span>
<span><span class="co">#&gt;  [9] "prior_pars_global_error_sigma" "model"</span></span></code></pre></div>
<p>Each represents an element of the list that gets passed to the model:
- <code>n_obs</code> is the integer number of observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
- <code>n_ind</code> is the integer number of individuals -
<code>y_obs</code> is the vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
observations and should have length <code>n_obs</code> -
<code>obs_index</code> is a vector containing integer the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
index for individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and counts which observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
is in sequence - <code>time</code> is a vector that determines when an
observation happened relative to the first observation for that
individual. The first observation has time 0 - <code>ind_id</code> is a
vector the same length as <code>y_obs</code> that tracks which
individual an observation comes from -
<code>prior_pars_pop_log_beta_mu</code> is the vector of prior
parameters for the log-beta mean hyper-parameter -
<code>prior_pars_pop_log_beta_sigma</code> is the vector of prior
parameters for the log-beta standard deviation hyper-parameter -
<code>prior_pars_global_error_sigma</code> is the vector of prior
parameters for the global error standard deviation - <code>model</code>
is the name of the model</p>
<p>Now we will actually fit the model and extract the estimates. As the
provided trout data is already in the form required by the
<code>hmde_assign_data</code> function we don‚Äôt need to do any further
re-naming and can pass it directly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trout_constant_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_model.html">hmde_model</a></span><span class="op">(</span><span class="st">"constant_multi_ind"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hmde_assign_data.html">hmde_assign_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Trout_Size_Data</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hmde_run.html">hmde_run</a></span><span class="op">(</span>chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">1</span>, iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'constant_multi_ind' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 2.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.66 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.555 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                1.215 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'constant_multi_ind' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 2.1e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.21 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 0.622 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                0.43 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                1.052 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'constant_multi_ind' NOW (CHAIN 3).</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Gradient evaluation took 2.1e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.21 seconds.</span></span>
<span><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3:  Elapsed Time: 0.661 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 3:                0.438 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3:                1.099 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'constant_multi_ind' NOW (CHAIN 4).</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: Gradient evaluation took 2.2e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.</span></span>
<span><span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4:  Elapsed Time: 0.637 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 4:                0.525 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4:                1.162 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 4:</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inspect-estimates">Inspect estimates<a class="anchor" aria-label="anchor" href="#inspect-estimates"></a>
</h3>
<p>Once the model has finished running, we can extract the model
estimates and have a look at the distribution of estimated sizes,
estimated growth increments, and annualised growth rates at the level of
sizes over time.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trout_constant_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_extract_estimates.html">hmde_extract_estimates</a></span><span class="op">(</span>                                 </span>
<span>                                 fit <span class="op">=</span> <span class="va">trout_constant_fit</span>,</span>
<span>                                 input_measurement_data <span class="op">=</span> <span class="va">Trout_Size_Data</span><span class="op">)</span></span></code></pre></div>
<p>First, let‚Äôs do some quick data wrangling to calculate our parameters
of interest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">measurement_data_transformed</span> <span class="op">&lt;-</span> <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">measurement_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    delta_y_obs <span class="op">=</span> <span class="va">y_obs</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">)</span>,</span>
<span>    obs_interval <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>    obs_growth_rate <span class="op">=</span> <span class="va">delta_y_obs</span><span class="op">/</span><span class="va">obs_interval</span>,</span>
<span>    delta_y_est <span class="op">=</span> <span class="va">y_hat</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_hat</span><span class="op">)</span>,</span>
<span>    est_growth_rate <span class="op">=</span> <span class="va">delta_y_est</span><span class="op">/</span><span class="va">obs_interval</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now we can have a look at the distirbution of each of the estimated
parameter by creating histograms</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">est_hist_y_hat</span> <span class="op">&lt;-</span> <span class="fu">histogram_func</span><span class="op">(</span><span class="va">measurement_data_transformed</span>, <span class="va">y_hat</span>, </span>
<span>               <span class="st">"Estimated size distribution"</span>,</span>
<span>               xlab <span class="op">=</span> <span class="st">"Size (cm)"</span>,</span>
<span>               bins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_hist_delta_y_est</span> <span class="op">&lt;-</span>  <span class="fu">histogram_func</span><span class="op">(</span><span class="va">measurement_data_transformed</span>, <span class="va">delta_y_est</span>, </span>
<span>               <span class="st">"Estimated growth  \n increments"</span>,</span>
<span>               xlab <span class="op">=</span> <span class="st">"Growth increment (cm)"</span>,</span>
<span>               bins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_hist_growth_rate</span> <span class="op">&lt;-</span> <span class="fu">histogram_func</span><span class="op">(</span><span class="va">measurement_data_transformed</span>, <span class="va">est_growth_rate</span>, </span>
<span>               <span class="st">"Estimated annualised growth rate distribution"</span>, xlab <span class="op">=</span> <span class="st">"Growth rate (cm/yr)"</span>,</span>
<span>               bins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">est_hist_y_hat</span> <span class="op">+</span> <span class="va">est_hist_delta_y_est</span><span class="op">)</span> <span class="op">/</span> <span class="va">est_hist_growth_rate</span> </span></code></pre></div>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can see that the negative growth increments are gone! Because we
fit a positive growth function
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mi>Œ≤</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f = \beta &gt; 0</annotation></semantics></math>)
the model cannot actually estimate negative growth increments.</p>
<div class="section level4">
<h4 id="r2">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#r2"></a>
</h4>
<p>We can also directly compare the observed sizes over time to
estimated values.</p>
<p>We can use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
calculated on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mover><mi>Y</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(y_{ij}, \hat{Y}_{ij})</annotation></semantics></math>,
and inspect we can look at plots of sizes over time. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
statistic is a metric primarily used in linear regression that measures
the proportion (ie. decimal value in the [0,1] interval) of variance in
one coordinate that can be explained by the regression model. In this
context, we interpret it as how strongly the fitted and observed values
agree. We don‚Äôt expect perfect agreement ‚Äì
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R^2=1</annotation></semantics></math>
‚Äì because we don‚Äôt get perfect agreement. <span class="citation">O‚ÄôBrien, Warton, and Falster (2024)</span> showed that
the change between observed and fitted values can actually correct for
measurement errors in size, so disagreement is not a bad thing
overall.</p>
<p>In the next block, we are looking at 5 random individuals to start
with because plotting every individuals‚Äô sizes over time can get very
messy.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Quantitative R^2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">measurement_data_transformed</span><span class="op">$</span><span class="va">y_obs</span>, <span class="va">measurement_data_transformed</span><span class="op">$</span><span class="va">y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.9540111</span></span>
<span><span class="va">r_sq_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">$</span><span class="va">y_obs</span>,</span>
<span>                          <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">$</span><span class="va">y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">r_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"R^2 = "</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">r_sq_est</span>,</span>
<span>                      digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_est_size_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">measurement_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_obs</span>, y <span class="op">=</span> <span class="va">y_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"green4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Y obs."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Y est."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">45</span>, y <span class="op">=</span> <span class="fl">80</span>, </span>
<span>           label <span class="op">=</span> <span class="va">r_sq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">obs_est_size_plot</span></span></code></pre></div>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Plots of size over time for a sample of 5 individuals</span></span>
<span><span class="va">size_over_time_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_plot_obs_est_inds.html">hmde_plot_obs_est_inds</a></span><span class="op">(</span>n_ind_to_plot <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       measurement_data <span class="op">=</span> <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">)</span></span>
<span><span class="va">size_over_time_plot</span></span></code></pre></div>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-13-2.png" width="384" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="indvidual-growth-functions-beta">Indvidual growth functions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#indvidual-growth-functions-beta"></a>
</h3>
<p>At the level of individuals we are interested in the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
estimates, which will align with the estimated annualised growth rates
as that‚Äôs precisely what they represent. Here is one way to visualise
the fitted growth functions in order to see how they compare to the
observed sizes.</p>
<p><img src="constant-growth_files/figure-html/unnamed-chunk-14-1.png" width="624" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="population-hyper-parameters">Population hyper-parameters<a class="anchor" aria-label="anchor" href="#population-hyper-parameters"></a>
</h3>
<p>We also get estimates of the population-level hyper-parameters that
govern the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
‚Äì
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
for the log-normal distribution. These are calculated in the context of
the log-transformed parameters so the easiest way to interpret
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is to back-transform it through exponentiation, but this does not so
easily transfer to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>.
The CIs in this output are posterior credible intervals taken as the
central 95% quantiles of the posterior samples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Mean of normal distribution</span></span>
<span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co">#Raw value</span></span>
<span><span class="co">#&gt; [1] 0.8812017</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI for mean log growth: ("</span>, </span>
<span>             <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">" , "</span>,</span>
<span>             <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_upper</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="co">#Raw CI</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean log growth: (0.577979967794788 , 1.11797940744988)"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#In cm/yr units</span></span>
<span><span class="co">#&gt; [1] 2.413799</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI for mean growth in cm/yr: ("</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">" , "</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_upper</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean growth in cm/yr: (1.78243421713959 , 3.05866763409531)"</span></span>
<span></span>
<span><span class="co">#Standard deviation of underlying normal distribution</span></span>
<span><span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.4846497</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI for log growth standard deviation: ("</span>, </span>
<span>             <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_lower</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">" , "</span>,</span>
<span>             <span class="va">trout_constant_estimates</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_upper</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="co">#Raw CI</span></span>
<span><span class="co">#&gt; [1] "95% CI for log growth standard deviation: (0.173827701537664 , 0.8358819473229)"</span></span></code></pre></div>
<p>From the species-level data we can say that the average annual growth
rate for the species is estimated to be 2.4cm/yr, with a 95% posterior
CI of (1.83, 3.04). As we fit a constant growth model there‚Äôs only so
much we can say about the growth behaviour.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-moe2020_TroutData" class="csl-entry">
Moe, S Jannicke, Chlo√© R Nater, Atle Rustadbakken, L Asbj√∏rn V√∏llestad,
Espen Lund, Tore Qvenild, Ola Hegge, and Per Aass. 2020.
<span>‚ÄúLong-Term Mark-Recapture and Growth Data for Large-Sized
Migratory Brown Trout (Salmo Trutta) from Lake Mj<span>√∏</span>sa,
Norway.‚Äù</span> <em>Biodiversity Data Journal</em> 8.
</div>
<div id="ref-obrien2024allindividuals" class="csl-entry">
O‚ÄôBrien, Tess, David Warton, and Daniel Falster. 2024. <span>‚ÄúYes,
They‚Äôre All Individuals: Hierarchical Models for Repeat Survey Data
Improve Estimates of Tree Growth and Sie.‚Äù</span> <em>Methods in Ecology
and Evolution</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falster, Tess O‚ÄôBrien, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
