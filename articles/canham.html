<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case study 3: Canham function growth with tree data from Barro Colorado Island • hmde</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study 3: Canham function growth with tree data from Barro Colorado Island">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hmde</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hmde.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/constant-growth.html">Constant growth model</a></li>
    <li><a class="dropdown-item" href="../articles/von-bertalanffy.html">von Bertalanffy model</a></li>
    <li><a class="dropdown-item" href="../articles/canham.html">Canham model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/traitecoevo/hmde/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Case study 3: Canham function growth with tree data from Barro Colorado Island</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/traitecoevo/hmde/blob/master/vignettes/canham.Rmd" class="external-link"><code>vignettes/canham.Rmd</code></a></small>
      <div class="d-none name"><code>canham.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://traitecoevo.github.io/hmde/">hmde</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Our final case study reproduces analysis from <span class="citation">O’Brien, Warton, and Falster (2024)</span> with a small
sample size for G. recondita in order to make the model tractable for a
demonstration.</p>
<p>The function we use here is based on <span class="citation">Canham,
LePage, and Coates (2004)</span>, and is a three parameter non-linear
ODE given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>;</mo><mspace width="0.167em"></mspace><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>exp</mo><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mfrac><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>k</mi></mfrac><msup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">g(S(t);\, g_{max}, S_{max}, k) = g_{max} \exp \Bigg(-\frac{1}{2}\bigg(\frac{\ln(S(t)/S_{max})}{k} \bigg)^2 \Bigg).</annotation></semantics></math>
The Canham function, as we refer to it, describes hum-shaped growth that
accelerates to a peak at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(S_{max}, g_{max})</annotation></semantics></math>
then declines to 0 at a rate controlled by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
The Canham function does not have an analytic solution the way that the
previous function did, so we are unable to directly encode the sizes
over time and must instead use a numerical method.</p>
<p>The Canham function has been used for a lot of growth analysis such
as <span class="citation">Herault et al. (2011)</span> and <span class="citation">Canham et al. (2006)</span> as well as our own previous
work in <span class="citation">O’Brien, Warton, and Falster
(2024)</span> and [Paper 2]. The desirable features of the Canham growth
model are that it has a period of increasing growth at small sizes, with
a finite growth peak at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(S_{max}, g_{max})</annotation></semantics></math>,
and then decay to near-zero growth. With different parameter
combinations Canham can fit a range of growth behaviours to an observed
interval: increasing growth, decreasing growth, a growth spike, or
steady growth. The downside is that the Canham function is unimodal – it
can only fit a single peak and as such is not suitable to describe the
full life history of species that are strongly responsive to their
environment as seen in [Paper 2].</p>
<p>The next bit of code plots the Canham function for chosen parameter
values. We have provided some, but encourage playing around with the
parameters and seeing what happens to the function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_max</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#Max growth rate</span></span>
<span><span class="va">S_max</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co">#Size at which the maximum growth occurs</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">y_0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#Starting size</span></span>
<span><span class="va">y_final</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span></span>
<span><span class="co">#Plot of growth function</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="va">y_0</span>, <span class="va">y_final</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Y(t)"</span>, y <span class="op">=</span> <span class="st">"f"</span>, title <span class="op">=</span> <span class="st">"Canham growth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="fu"><a href="../reference/hmde_model_des.html">hmde_model_des</a></span><span class="op">(</span><span class="st">"canham_single_ind"</span><span class="op">)</span>,</span>
<span>                args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g_max</span>, <span class="va">S_max</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                colour<span class="op">=</span><span class="st">"green4"</span>, linewidth<span class="op">=</span><span class="fl">1</span>,</span>
<span>                xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_0</span>, <span class="va">y_final</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The default priors for the Canham top-level parameters for the single
individual model are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>∼</mo><mo>log</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">g_{max} \sim \log\mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>∼</mo><mo>log</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">S_{max} \sim \log\mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∼</mo><mo>log</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k \sim \log\mathcal{N}(0, 2)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>σ</mi><mi>e</mi></msub><mo>∼</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">0 &lt;\sigma_e \sim Cauchy(0, 2).</annotation></semantics></math>
For the multi-individual model the prior structure and default
parameters are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mu_{g_{max}} \sim \mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>σ</mi><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>∼</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">0 &lt; \sigma_{g_{max}} \sim Cauchy(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mu_{S_{max}} \sim \mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>σ</mi><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>∼</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">0 &lt; \sigma_{S_{max}} \sim Cauchy(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mu_{k} \sim \mathcal{N}(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>σ</mi><mi>k</mi></msub><mo>∼</mo><mo>∼</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">0 &lt; \sigma_{k} \sim \sim Cauchy(0, 2),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>σ</mi><mi>e</mi></msub><mo>∼</mo><mi>C</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">0 &lt;\sigma_e \sim Cauchy(0, 2).</annotation></semantics></math>
To see the name for the prior parameter run <code>hmde_model</code>. For
example in the following we want to change the prior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">g_{max}</annotation></semantics></math>
(<code>ind_max_growth</code>) in the individual model:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hmde_model.html">hmde_model</a></span><span class="op">(</span><span class="st">"canham_single_ind"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_obs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $y_obs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $obs_index</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $time</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_ind_max_growth</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_ind_size_at_max_growth</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_ind_k</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior_pars_global_error_sigma</span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; [1] "canham_single_ind"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "hmde_object"</span></span>
<span><span class="co">#prior_pars_ind_max_growth is the argument name for the prior parameters</span></span></code></pre></div>
The data we use for this demonstration comes from the Barro Colorado
Island long term forest plot <span class="citation">Condit et al.
(2019)</span>. We have a simple random sample without replacement of 50
individuals from , subject to the following inclusion criteria for
individuals:
<p>As some exploratory analysis we’re going to look at the size and
growth increment distributions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Tree_Size_Data</span><span class="op">$</span><span class="va">y_obs</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Size (cm)"</span>, main <span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Tree_Size_Data_Transformed</span> <span class="op">&lt;-</span> <span class="va">Tree_Size_Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Delta_y_obs <span class="op">=</span> <span class="va">y_obs</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ind_id</span>, <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Delta_y_obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Tree_Size_Data_Transformed</span><span class="op">$</span><span class="va">Delta_y_obs</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Growth increment (cm)"</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>Due to the complexity of the Canham model the sampling can take up to
3 hours. If you decide to run your own samples we recommend saving the
model outputs using <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> so you don’t need to rerun
your model every time. We provide a data set of estimates with the
package in the <code>Tree_Size_Ests</code> data file which can be
accessed directly.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_canham_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_model.html">hmde_model</a></span><span class="op">(</span><span class="st">"canham_multi_ind"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hmde_assign_data.html">hmde_assign_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tree_Size_Data</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hmde_run.html">hmde_run</a></span><span class="op">(</span>chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_canham_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_extract_estimates.html">hmde_extract_estimates</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">tree_canham_fit</span>,</span>
<span>                                 input_measurement_data <span class="op">=</span> <span class="va">Tree_Size_Data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(tree_canham_fit, "tree_canham_fit.rds")</span></span>
<span><span class="co">#saveRDS(tree_canham_estimates, "tree_canham_estimates.rds")</span></span></code></pre></div>
<p>The model analysis follows the same workflow as the previous
demonstrations: we look at how individual sizes over time and fitted
growth functions behave, then examine evidence of relationships between
parameter values at the individual level. We also look at the
species-level parameter CIs and estimates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">measurement_data_transformed</span> <span class="op">&lt;-</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">measurement_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    delta_y_obs <span class="op">=</span> <span class="va">y_obs</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">)</span>,</span>
<span>    obs_interval <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>    obs_growth_rate <span class="op">=</span> <span class="va">delta_y_obs</span><span class="op">/</span><span class="va">obs_interval</span>,</span>
<span>    delta_y_est <span class="op">=</span> <span class="va">y_hat</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y_hat</span><span class="op">)</span>,</span>
<span>    est_growth_rate <span class="op">=</span> <span class="va">delta_y_est</span><span class="op">/</span><span class="va">obs_interval</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Distributions of estimated growth and size</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">measurement_data_transformed</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">y_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Size (cm)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Estimated size distribution"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">measurement_data_transformed</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">delta_y_est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Growth increment (cm)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Estimated growth increments"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 50 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_bin()`).</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">measurement_data_transformed</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">est_growth_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Growth rate (cm/yr)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Estimated annualised growth rate distribution"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 50 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_bin()`).</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-7-3.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Quantitative R^2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">measurement_data_transformed</span><span class="op">$</span><span class="va">y_obs</span>, <span class="va">measurement_data_transformed</span><span class="op">$</span><span class="va">y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.9975655</span></span>
<span></span>
<span><span class="va">r_sq_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">$</span><span class="va">y_obs</span>,</span>
<span>                <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">$</span><span class="va">y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">r_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"R^2 = "</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">r_sq_est</span>,</span>
<span>                      digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_est_scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">measurement_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_obs</span>, y <span class="op">=</span> <span class="va">y_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"green4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Y obs."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Y est."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">7</span>, y <span class="op">=</span> <span class="fl">22</span>, </span>
<span>           label <span class="op">=</span> <span class="va">r_sq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">obs_est_scatter</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-7-4.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Plots of size over time for a sample of 5 individuals</span></span>
<span><span class="va">obs_est_size_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_plot_obs_est_inds.html">hmde_plot_obs_est_inds</a></span><span class="op">(</span>n_ind_to_plot <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       measurement_data <span class="op">=</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">measurement_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>        legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obs_est_size_plot</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-7-5.png" width="700"></p>
<p>Individual parameter analysis, growth function plots follow this.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#1-dimensional parameter distributions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">ind_max_growth_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"g_max estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">ind_size_at_max_growth_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"S_max estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">ind_k_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"k estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#2-dimensional parameter distributions</span></span>
<span><span class="va">pairplot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ind_max_growth_mean</span>, y <span class="op">=</span> <span class="va">ind_size_at_max_growth_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"green4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Ind. max growth (cm/yr)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Ind. size at max growth (cm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ind_max_growth_mean</span>, y <span class="op">=</span> <span class="va">ind_k_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"green4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Ind. max growth (cm/yr)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Ind. spread par."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairplot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ind_k_mean</span>, y <span class="op">=</span> <span class="va">ind_size_at_max_growth_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"green4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Ind. spread par."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Ind. size at max growth (cm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairplot1</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairplot2</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-5.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairplot3</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-6.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#monotonic correlation of parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">individual_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                             ind_max_growth_mean ind_size_at_max_growth_mean</span></span>
<span><span class="co">#&gt; ind_max_growth_mean                   1.0000000                   0.1714766</span></span>
<span><span class="co">#&gt; ind_size_at_max_growth_mean           0.1714766                   1.0000000</span></span>
<span><span class="co">#&gt; ind_k_mean                           -0.5167347                  -0.2566627</span></span>
<span><span class="co">#&gt;                             ind_k_mean</span></span>
<span><span class="co">#&gt; ind_max_growth_mean         -0.5167347</span></span>
<span><span class="co">#&gt; ind_size_at_max_growth_mean -0.2566627</span></span>
<span><span class="co">#&gt; ind_k_mean                   1.0000000</span></span>
<span></span>
<span><span class="co">#Plot function pieces over estimated sizes.</span></span>
<span><span class="va">est_de_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmde_plot_de_pieces.html">hmde_plot_de_pieces</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">)</span></span>
<span><span class="va">est_de_plot</span></span></code></pre></div>
<p><img src="canham_files/figure-html/unnamed-chunk-8-7.png" width="700"></p>
<p>At the hyper-parameter level for the whole population we have centre
and spread parameters for the log-normal distributions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">g_{max}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">S_{max}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars_CI_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"mean log max growth rate"</span>,</span>
<span>  <span class="st">"mean max growth rate in cm/yr"</span>,</span>
<span>  <span class="st">"log max growth rate standard deviation"</span>,</span>
<span>  <span class="st">"mean log size at max growth rate"</span>,</span>
<span>  <span class="st">"mean max size at max growth rate in cm"</span>,</span>
<span>  <span class="st">"log max size at growth rate standard deviation"</span>,</span>
<span>  <span class="st">"mean mean log spread parameter"</span>,</span>
<span>  <span class="st">"mean mean spread parameter"</span>,</span>
<span>  <span class="st">"log spread parameter standard deviation"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Vector that picks out which pars to be exponentiated</span></span>
<span><span class="va">exp_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, </span>
<span>             <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>,</span>
<span>             <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Print mean estimates and CIs</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">exp_vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">pars_CI_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                 <span class="st">" estimate: "</span>,</span>
<span>                 <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI for "</span>, </span>
<span>                 <span class="va">pars_CI_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                 <span class="st">": ("</span>,</span>
<span>                 <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                 <span class="st">", "</span>,</span>
<span>                 <span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                 <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">pars_CI_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                 <span class="st">" estimate: "</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI for "</span>,</span>
<span>                 <span class="va">pars_CI_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                 <span class="st">": ("</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                 <span class="st">", "</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Tree_Size_Ests</span><span class="op">$</span><span class="va">population_data</span><span class="op">$</span><span class="va">CI_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                 <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "mean log max growth rate estimate: -1.17926905960628"</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean log max growth rate: (-1.35436217487034, -1.0097451150757)"</span></span>
<span><span class="co">#&gt; [1] "mean max growth rate in cm/yr estimate: 1.54915299226772"</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean max growth rate in cm/yr: (1.38279241021618, 1.75860470370369)"</span></span>
<span><span class="co">#&gt; [1] "log max growth rate standard deviation estimate: 2.31924077864107"</span></span>
<span><span class="co">#&gt; [1] "95% CI for log max growth rate standard deviation: (2.14197700118498, 2.51005094657254)"</span></span>
<span><span class="co">#&gt; [1] "mean log size at max growth rate estimate: 0.385303309010744"</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean log size at max growth rate: (0.236341614765895, 0.552561575432935)"</span></span>
<span><span class="co">#&gt; [1] "mean max size at max growth rate in cm estimate: 0.56896188306983"</span></span>
<span><span class="co">#&gt; [1] "95% CI for mean max size at max growth rate in cm: (0.422533038841024, 0.803549795885537)"</span></span>
<span><span class="co">#&gt; [1] "log max size at growth rate standard deviation estimate: 0.583806457525299"</span></span>
<span><span class="co">#&gt; [1] "95% CI for log max size at growth rate standard deviation: (0.351536816347528, 0.866585624778698)"</span></span></code></pre></div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-canham2004neighborhood" class="csl-entry">
Canham, Charles D, Philip T LePage, and K Dave Coates. 2004. <span>“A
Neighborhood Analysis of Canopy Tree Competition: Effects of Shading
Versus Crowding.”</span> <em>Canadian Journal of Forest Research</em> 34
(4): 778–87.
</div>
<div id="ref-canham2006neighborhood" class="csl-entry">
Canham, Charles D, Michael J Papaik, Marı́a Uriarte, William H
McWilliams, Jennifer C Jenkins, and Mark J Twery. 2006.
<span>“Neighborhood Analyses of Canopy Tree Competition Along
Environmental Gradients in New England Forests.”</span> <em>Ecological
Applications</em> 16 (2): 540–54.
</div>
<div id="ref-condit2019dataset" class="csl-entry">
Condit, R, R Pérez, S Aguilar, S Lao, R Foster, and S. P. Hubbell. 2019.
<span>“Complete Data from the Barro Colorado 50-Ha Plot: 423617 Trees,
35 Years, 2019 Version.”</span>
</div>
<div id="ref-herault2011functional" class="csl-entry">
Herault, Bruno, Bénédicte Bachelot, Lourens Poorter, Vivien Rossi, Frans
Bongers, Jérôme Chave, CE Timothy Paine, Fabien Wagner, and Christopher
Baraloto. 2011. <span>“Functional Traits Shape Ontogenetic Growth
Trajectories of Rain Forest Tree Species.”</span> <em>Journal of
Ecology</em> 99 (6): 1431–40.
</div>
<div id="ref-obrien2024allindividuals" class="csl-entry">
O’Brien, Tess, David Warton, and Daniel Falster. 2024. <span>“Yes,
They’re All Individuals: Hierarchical Models for Repeat Survey Data
Improve Estimates of Tree Growth and Sie.”</span> <em>Methods in Ecology
and Evolution</em>.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falster, Tess O’Brien, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
